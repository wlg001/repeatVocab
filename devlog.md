# 开发日志 (Development Log)

## 2025-12-08

### Commit 1: Initial commit (35f6207)
**用户需求：** 创建一个英语单词听默APP，本地web程序
- 熟练度系统（初始-100，正确+1，错误-1）
- 实时拼写检查，错误立即重新输入
- 两种练习模式（听发音/看中文，可混合）
- 连续错误5次显示答案
- 批量导入单词
- 统计功能
- 中文界面

**实现内容：**
- 创建基础HTML结构（index.html）
- 实现VSCode深色主题样式（style.css）
- 实现完整业务逻辑（app.js）
  - Storage模块：LocalStorage数据存储
  - PracticeManager：练习逻辑管理
  - AudioManager：Web Speech API发音
  - UIController：界面控制
- 创建README.md项目文档
- 三个标签页：练习、单词管理、统计

---

### Commit 2: feat: 重复添加单词时重置熟练度为-100 (c386d75)
**用户需求：** 如果这个单词被重复添加，就把熟练度重置为-100

**实现内容：**
- 单个添加模式：弹出确认对话框，确认后重置熟练度并更新释义
- 批量导入模式：自动重置已存在单词的熟练度为-100
- 更新导入统计提示信息（移除"跳过"统计，改为包含在"成功"中）

---

### Commit 3: fix: 优化错误typing统计逻辑 (8df8807)
**用户需求：** 任何一次字母拼写错误（即需要重新输入）的时候，都算一次错误的typing

**实现内容：**
- 添加`errorRecorded`标记，防止单次输入重复计数
- 每次字母拼写错误只记录一次错误typing
- 清空输入后重置标记，允许下次输入重新记录
- 更新lastPracticeTime时间戳

---

### Commit 4: feat: 显示连续错误次数提示 (3d6b0f9)
**用户需求：** 每次判定错误的时候，也显示"连续错误次数X"提示

**实现内容：**
- 每次判定字母拼写错误时显示连续错误次数
- 提示格式：`✗ 字母错误！请重新输入完整单词 (连续错误X次)`

---

### Commit 5: feat: 连续错误5次显示正确答案 (0ffe284)
**用户需求：** 连续错误次数到5次的时候，显示该单词正确的拼写和词义

**实现内容：**
- 连续错误达到5次时显示单词拼写和所有词义
- 显示格式：`连续错误5次！正确答案是: word (释义1；释义2)`
- 显示3秒后自动切换到下一个单词
- 重置连续错误计数

---

### Commit 6: fix: 延长正确答案显示时间到3秒 (8fd4785)
**用户需求：** 正确的单词拼写和中文释义显示没有停留3秒

**实现内容：**
- 拼写正确时显示答案从1.5秒延长到3秒
- 与连续错误5次显示答案的时间保持一致

---

### Commit 7: fix: 调整答案显示时间 (53cc3e4)
**用户需求：** 我输入正确的拼写时，显示单词1秒即可。连续错误输入5次时，显示3秒让我记忆

**实现内容：**
- 拼写正确时：显示1秒后进入下一题（快速反馈）
- 连续错误5次：显示3秒后进入下一题（增强记忆）

---

### Commit 8: fix: 修复连续错误5次答案显示时间问题 (5453fda)
**用户需求：** 测试了下，拼写正确时的显示没有问题，但是拼写错误时，正确的显示并没有停留3秒

**实现内容：**
- 达到5次错误时禁用输入框，防止继续输入
- 修正else if条件，避免执行冲突的清空逻辑
- 确保答案完整显示3秒后再切换到下一题

---

### Commit 9: refactor: 重新梳理拼写错误处理逻辑 (8d69997)
**用户需求：** 重新梳理逻辑：每次拼写需要依次输入字母，如果全部正确显示单词+释义，如果中途错误立即重置并提示连续错误次数，5次后显示答案停留3秒

**实现内容：**
- 简化逻辑，移除多余的else if分支
- 字母拼写正确：显示单词+释义，1秒后下一题
- 字母拼写错误：立即重置需重新输入，提示连续错误次数
- 连续错误5次：显示答案停留3秒，然后下一题
- 未达到5次时只清空输入框，不调用clearInput
- 达到5次时禁用输入框，确保显示3秒

---

### Commit 10: fix: 统一答案显示样式为绿框 (6fc974b)
**用户需求：** 如果全部字母拼写正确，则绿框显示完整的单词拼写+中文释义。连续错误5次时，也是绿框显示完整的单词拼写+中文释义

**实现内容：**
- 拼写正确：绿框显示 `✓ word + 释义`，停留1秒
- 连续错误5次：绿框显示 `word + 释义`，停留3秒
- 中途拼写错误：红框提示连续错误次数
- 新增`showCorrectAnswerForError`方法处理5次错误的显示逻辑

---

### Commit 11: perf: 拼写正确后立即显示绿框 (fa05ce3)
**用户需求：** 拼写正确后（最后一个字母输入后）立即显示正确的绿框。（更快速，更丝滑）

**实现内容：**
- 移除500ms延迟，最后一个字母输入后立即显示答案
- 提升响应速度，更加丝滑流畅的用户体验

---

### Commit 12: feat: 显示答案时自动播放单词发音 (3d9f1bb)
**用户需求：** 显示绿框的时候，再次自动播放一次单词的发音

**实现内容：**
- 拼写正确显示绿框时自动播放单词发音
- 连续错误5次显示绿框时自动播放单词发音
- 增强记忆效果，提供视觉+听觉双重反馈

---

### Commit 13: feat: 支持设置熟练度区间 (05c5f3f)
**用户需求：** 练习模式，支持设置熟练度区间。（只练习熟练度区间内的单词）

**实现内容：**
- 练习设置界面新增熟练度区间输入框（最低熟练度、最高熟练度）
- 默认区间：-100 ~ 100（包含所有单词）
- 只练习熟练度在区间内的单词
- 从区间内选择熟练度最低的20个单词随机练习
- 开始练习前验证：
  - 区间数值有效性
  - 最低熟练度不能大于最高熟练度
  - 区间内必须有单词
- 新增Storage.getWordsByProficiencyRange()方法
- 新增PracticeManager.setProficiencyRange()方法

---

### Commit 14: refactor: 优化练习页面UI布局 (40bfe5f)
**用户需求：** UI修改下，练习模式下面加个操作栏，听发音模式，看中文模式，熟练度区间，开始练习显示在这个操作栏里。点击开始练习，直接在操作栏下面（网页核心区域）开始练习。

**实现内容：**
- 将练习模式、熟练度区间、开始/结束按钮整合到一个横向操作栏
- 操作栏使用flexbox布局，更紧凑简洁
- 点击开始练习后操作栏保留在顶部，练习区域在下方展开
- 开始练习时自动切换按钮显示（开始→结束）
- 移除原有的垂直布局设置界面
- 简化模式名称（听发音默写→听发音，看中文默写→看中文）
- 熟练度区间使用内联输入框，用波浪号分隔

---

### Commit 15: refactor: 重构标题栏为两层结构 (025133d)
**用户需求：** 练习模式操作栏可以和主标题栏更好的衔接吗？我的意思是有两个标题栏，第一栏显示当前的练习/单词管理/统计三个tab页，第二栏显示当前的练习模式操作栏。

**实现内容：**
- 重构为两层标题栏结构
  - 第一层：主导航栏（应用标题 + Tab标签）
  - 第二层：练习模式操作栏（练习设置和控制按钮）
- 将Tab导航集成到主标题栏内，使用flexbox布局
- 练习操作栏作为独立的第二标题栏，背景色与Tab栏一致
- 移除操作栏的边框和圆角，使其更好地衔接主标题栏
- 调整Tab按钮样式，使用伪元素实现顶部高亮
- 统一两层标题栏的视觉风格和间距

---

### Commit 16: feat: 练习操作栏仅在练习Tab显示 (92aa50b)
**用户需求：** 练习操作栏只有在主导航栏选择的是练习的时候显示

**实现内容：**
- 在switchTab函数中添加练习操作栏显示/隐藏逻辑
- 选择"练习"Tab时，第二标题栏（操作栏）显示
- 切换到"单词管理"或"统计"Tab时，操作栏自动隐藏
- 保持操作栏状态与当前Tab同步

---

### Commit 17: feat: 单词管理列表显示加入日期 (5cc99dc)
**用户需求：** 单词管理显示每个单词加入的日期

**实现内容：**
- 在单词列表每项的元数据中添加"加入时间"显示
- 使用中文日期格式（YYYY/MM/DD）显示单词添加日期
- 日期信息显示在练习次数、正确次数、错误次数之前
- 便于用户了解单词的添加历史和管理时间线

---

### Commit 18: feat: 添加今日新词练习模式 (cac9d65)
**用户需求：** 练习模式增加一个按钮（今日新词练习）目的，选中状态下，只练习今日新增的单词。

**实现内容：**
- 在练习操作栏添加"今日新词练习"复选框
- Storage类添加getTodayNewWords()方法，筛选当天添加的单词
- PracticeManager添加todayNewWordsOnly属性和setTodayNewWordsOnly()方法
- getNextWord()方法支持今日新词模式，优先级高于熟练度区间
- 开启今日新词模式时，如果没有今天添加的单词会提示用户
- 今日新词练习与熟练度区间相互独立，可单独使用

---

### Commit 19: feat: 添加打卡日历功能 - 显示每日练习记录 (82b5a2a)
**用户需求：** 统计里显示打卡日历，记录对应日期的练习记录（练习过多少个单词，正确输入总次数）

**实现内容：**
- 在统计页面添加打卡日历视图，显示月度练习情况
- Storage类添加练习日志功能（getPracticeLog, savePracticeLog, recordTodayPractice）
- 每次练习（无论正确或错误）都记录到当日日志中
- 日历按练习强度显示不同颜色：
  - 未练习：深灰色
  - 1-5个单词：浅绿色
  - 6-15个单词：中绿色
  - 16+个单词：深绿色
- 日历格子显示练习单词数和正确次数（如"5词 3对"）
- 支持切换月份查看历史练习记录
- 今日日期用蓝色边框高亮显示
- 添加图例说明不同颜色含义

---

### Commit 20: style: 优化日历样式 - 更紧凑美观 (fde9347)
**用户需求：** 打开日历显示的太丑了，也太大了。

**实现内容：**
- 缩小日历整体尺寸，添加max-width: 600px限制
- 减小日期格子的内边距和间距，使布局更紧凑
- 减小字体大小（标题14px，日期11px，统计9px）
- 优化hover效果，放大至1.08倍并添加z-index
- 今日日期添加蓝色阴影效果，更醒目
- 有练习记录的日期数字改用青绿色（#4ec9b0）
- 高强度练习日期数字加粗显示
- 其他月份日期透明度降至0.2，减少干扰
- 减小图例元素尺寸和间距
- 练习统计文字改用浅蓝色（#9cdcfe）提升可读性

---

### Commit 21: feat: 添加浏览器同步存储功能 - 自动跨设备同步数据 (42ded1f)
**用户需求：** 我想在公司里用办公电脑可以练习，我也可以在家里练习，数据，学习记录肯定是统一份，有什么简单的方案可以实现吗？

**实现内容：**
- 实现方案3：浏览器同步存储（chrome.storage.sync）
- 数据双写策略：同时保存到localStorage和chrome.storage.sync
- 自动从云端同步数据到本地（页面加载时）
- 自动数据迁移：首次使用时将localStorage数据迁移到云端
- 降级处理：如果浏览器不支持同步存储，自动降级到localStorage
- 添加同步状态提示条，显示同步是否启用
- 同步提示5秒后自动隐藏

**使用方法：**
1. 在Chrome/Edge浏览器中登录相同账号
2. 打开应用，会自动启用同步（显示绿色提示）
3. 在不同设备上打开应用，数据会自动同步
4. 无需任何手动操作，完全透明

**技术细节：**
- chrome.storage.sync配额：每个key最大8KB，总计100KB
- 数据在浏览器账号间自动同步，通常几秒内完成
- localStorage作为本地缓存和降级方案
- 兼容非Chrome浏览器（自动降级）

---

### Commit 22: feat: 在练习界面右上角显示上一个单词 (9d760f9)
**用户需求：** 页面练习body界面，右上角显示上一个练习的单词（英文拼写+中文释义）

**实现内容：**
- 在练习区域右上角添加"上一个单词"显示框
- 显示内容包括：单词拼写（青绿色加粗）和中文释义（橙色）
- PracticeManager类添加lastWord属性记录上一个单词
- 每次切换到下一个单词时，自动更新上一个单词显示
- 停止练习时自动隐藏该显示框
- 样式采用深色卡片设计，与整体界面风格统一
- 最大宽度300px，防止释义过长影响布局

---

### Commit 23: feat: 上一个单词可点击跳转到剑桥词典查询 (2ad45c0)
**用户需求：** 右上角现在已经显示了上一个练习的单词，如果此时我想进一步学习这个单词，我想点击这个单词实现跳转到在线英语词典网页

**实现内容：**
- 将上一个单词的文本改为可点击的超链接
- 点击单词自动跳转到剑桥词典（Cambridge Dictionary）英汉双解页面
- URL格式：`https://dictionary.cambridge.org/dictionary/english-chinese-simplified/单词`
- 添加"(点击查词典)"提示文字，引导用户操作
- 新窗口打开词典页面（target="_blank"）
- 添加hover效果：鼠标悬停时颜色变浅、下划线、轻微右移动画
- 添加title属性显示完整提示信息

**选择剑桥词典的理由：**
- 权威性高，英语学习者首选
- 提供英汉双解，适合中国用户
- 有发音、例句、词形变化等完整信息
- 界面清晰，适合快速查询

---

### Commit 24: feat: 中文模式下添加首字母提示功能 (7e0944a)
**用户需求：** 中文模式下，可能存在一个中文对应多个英文单词的情况，所以中文模式下可以提示首字母

**实现内容：**
- 在中文练习模式下添加首字母提示区域
- 显示目标单词的首字母（自动转为大写）
- 提示样式：深色背景框，蓝色等宽字体，增加辨识度
- 仅在中文模式显示，音频模式自动隐藏

**HTML变更：**
- 在`chinese-mode-content`中添加`first-letter-hint`容器
- 包含`hint-label`（"首字母提示:"）和`hint-letter`（显示字母）两部分

**CSS变更：**
- `.first-letter-hint`: 深色背景#2d2d30，带边框，居中显示
- `.hint-label`: 灰色小字（#858585, 13px）
- `.hint-letter`: 蓝色粗体字母（#569cd6, 24px, Courier New等宽字体）

**JS逻辑变更：**
- 在`updatePracticeDisplay()`中添加首字母提取逻辑
- 使用`word.charAt(0).toUpperCase()`获取大写首字母
- 音频模式：隐藏提示区域（`display: none`）
- 中文模式：提取首字母并显示（`display: block`）

**解决的问题：**
- 消除中文释义歧义（如“bank”可能是“银行”或“河岸”）
- 提供适度提示，不直接给出答案
- 符合语言学习的渐进式提示原则

---

### Commit 25: feat: 中文模式在输入框直接显示首字母提示（浅色底+placeholder） (ee0cdd2)
**用户需求：** 中文模式下，不要首字母提示窗口，直接在单词拼写窗口显示首字母的浅色底

**实现内容：**
- 移除独立的first-letter-hint提示区域
- 在中文模式下给输入框添加`with-hint`类
- 使用CSS渐变在输入框左侧30px显示浅蓝色背景
- placeholder显示首字母+下划线（如"A____"）

**CSS变更：**
- `.word-input.with-hint`: 添加linear-gradient背景渐变
- 渐变范围：0-30px浅蓝色(rgba(86, 156, 214, 0.15))

**JS逻辑变更：**
- 音频模式：移除`with-hint`类，恢复默认placeholder
- 中文模式：添加`with-hint`类，动态生成placeholder
- placeholder格式：`${firstLetter}${'_'.repeat(word.word.length - 1)}`

---

### Commit 26: fix: 首字母保持原始大小写，输入框恢复居中显示 (554baae)
**用户需求：** 首字母该大写就大写，该小写就小写。居中显示

**实现内容：**
- 移除首字母强制转大写的逻辑（`.toUpperCase()`）
- 保持单词原始大小写：`word.charAt(0)`
- 移除输入框左对齐样式，恢复居中显示
- 移除`text-align: left`和额外的`padding-left`

**效果：**
- 输入框文本居中
- 浅蓝色渐变底保留在左侧
- 首字母显示符合原始大小写（apple显示a____，Apple显示A____）

---

### Commit 27: fix: 统一两种模式内容区域高度，避免输入框位置跳变 (4b72942)
**用户需求：** 中文模式的中文框和听音模式下的播放发音框，大小一致，位置固定（目的是避免拼写输入框位置跳变，影响输入时候视觉感官）

**实现内容：**
- 为`.mode-content`设置固定最小高度120px
- 中文释义框和音频按钮都设置`min-height: 120px`
- 使用flexbox垂直居中对齐内容
- 两种模式切换时，输入框位置保持稳定

**CSS变更：**
- `.mode-content`: 添加`min-height: 120px`、`display: flex`、`align-items: center`
- `.chinese-meaning`: 添加flexbox居中、最小高度120px、最大宽度600px
- `.btn-audio`: 增大尺寸(padding: 30px 40px)、最小高度120px、最小宽度200px

**解决的问题：**
- 消除模式切换时输入框上下跳动的问题
- 提升输入体验，保持视觉稳定性

---

### Commit 28: fix: 中文释义框添加水平居中显示 (d2da126)
**用户需求：** 中文释义框也居中显示

**实现内容：**
- 为`.chinese-meaning`添加`margin: 0 auto`
- 实现水平居中显示

---

### Commit 29: style: 中文字体缩小至22px，播放按钮背景色调淡 (7c13314)
**用户需求：** 中文显示框字体小点，播放发音框背景色淡些

**实现内容：**
- 中文释义框字体从28px缩小至22px
- 播放发音按钮背景色从#0e639c调淡至#094771
- hover效果相应调整：#1177bb → #0e639c

**CSS变更：**
- `.chinese-meaning`: `font-size: 28px` → `font-size: 22px`
- `.btn-audio`: `background: #0e639c` → `background: #094771`
- `.btn-audio:hover`: `background: #1177bb` → `background: #0e639c`

---

## 功能总结

### 已实现功能
- ✅ 熟练度系统（-100起始，正确+1，错误-1）
- ✅ 实时拼写检查和错误处理
- ✅ 两种练习模式（听发音/看中文）
- ✅ 连续错误5次显示答案（3秒）
- ✅ 批量导入单词支持
- ✅ 重复添加单词重置熟练度
- ✅ 完整统计功能
- ✅ VSCode深色主题界面
- ✅ LocalStorage本地数据持久化

### 技术栈
- HTML5 + CSS3 + Vanilla JavaScript
- LocalStorage API
- Web Speech API
- Git版本控制

### 下一步计划
- 待定
